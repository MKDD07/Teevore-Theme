{%- capture collection_list -%}
{%- liquid 
    assign section_st = section.settings
    assign page_width = settings.cntwd | append: 'px'
    if section_st.sw
        assign page_width = '100vw'
    endif  
    for block in section.blocks
        assign blk_st = block.settings
         
        assign collection = collections[blk_st.collection]
        assign collection_image = blk_st.image | default:collection.image | default: collection.products.first.featured_image

        assign img_ratio = 100
        if section_st.ratio == 'img' and collection_image
            assign img_ratio = 1 | divided_by: collection_image.aspect_ratio | times: 100
            break
        elsif section_st.ratio != 'img'
            assign img_ratio = section_st.ratio
        endif
    endfor
-%}
{%- capture sizes -%}
 (min-width:1400px) calc({{ page_width }} / {{ section_st.gridxxl }}),(min-width:1024px) calc({{ page_width }} / {{ section_st.grid }}),(min-width:768px) calc(100vw / {{ section_st.gridtb }}), calc(100vw / {{ section_st.gridmb | replace: '.', '_' }})
{%- endcapture -%}
<div class="collect-data sec_cov{% if section_st.hidem %} hide-sm{% endif %}{% if section_st.hided %} hide-md hide-lg{% endif %}{% if section_st.bgimg != blank %} bgImg lazyload zi1{% endif %}"
  style="--sbg:{% if section_st.bgg != blank %}{{ section_st.bgg }}{% else %}{{ section_st.bg }}{% endif %};--sst:{{ section_st.sst }}px;--ssb:{{ section_st.ssb }}px;--sstm:{{ section_st.sstm }}px;--ssbm:{{ section_st.ssbm }}px;--ttp:{{ section_st.tbp }}px;--tbp:{{ section_st.tbp | plus : 4 }}px;--overlay:{{ section_st.overlay | color_modify: 'alpha', section_st.overlay_op }};--ratio:{{ img_ratio | default:100 }}%"
  {% if section_st.bgimg != blank %}data-bgset="{{ section_st.bgimg | image_url: width: section_st.bgimg.width | image_tag: widths: '1000,1400,1600,2000,2400,3000' | split: 'srcset="' | last | split: '"' | first }}" data-sizes="auto" data-parent-fit="contain"{% endif %}>
    <div class="{% if section_st.sw %}fw-sec{% if section_st.npd %} npd{% endif %}{% else %}page-width{% endif %} pr zi1 cl_box" data-section-id="{{ section.id }}" style="--pdr: {{ section.settings.pdr }}px; --pdl: {{ section.settings.pdl }}px">   	
{%- render 'sec-title' -%}
        {%- capture collection_data -%}
          {%- for block in section.blocks -%}     
                {%- liquid
                  assign blk_st = block.settings                   
                  assign collection = collections[blk_st.collection]
                  assign collection_image = blk_st.image | default:collection.image | default: collection.products.first.featured_image
                  assign img_alt = collection_image.alt | default: blk_st.title | default: collection.title
                  assign count = collection.all_products_count            
                 
                %}
                
                <div class="gitem{% if section_st.carousel %} swiper-slide{% endif %} {% render 'animate-data', css:true %}" {% render 'animate-data' %} {{ block.shopify_attributes }}>
                      <a href="{{ blk_st.url | default:collection.url }}" class="db pr of_hidden brad{% if section_st.zoom %} zoom_hov{% endif %}" title="{{ blk_st.title }}" style="--rounded:{{ section_st.irad}}px;">                    
                        <div class="img pr of_hidden rounded10">
                          {%- if blk_st.media_type == 'video' and blk_st.video != blank -%}
                            {{
                              blk_st.video
                              | video_tag: 
                                  image_size: '1100x',
                                  autoplay: true,
                                  loop: true,
                                  controls: false,
                                  muted: true,
                                  class: 'imgFt',
                                  alt: img_alt
                            }}
                          {%- elsif collection_image != blank -%}
                            {{ collection_image | image_url: width: collection_image.width | image_tag: loading:'lazy', class:'imgFt', alt: img_alt, sizes:sizes, widths:"1000,1400,1600,2000,2400,3000" }}
                          {%- else -%}
                            {% capture current %}{% cycle 1, 2, 3, 4 %}{% endcapture %}{{ 'collection-apparel-' | append: current | placeholder_svg_tag: 'placeholder-svg imgFt' }}
                          {%- endif -%}
                        </div>
                      {% if section.settings.different_design %}
                      <div class="fl {{ section_st.text-align }} pa bottom0 pd10 w_100 fl-col f-jcsb zi2 rounded10"
                      {% if section.settings.enable_background %}
                        style="background: linear-gradient(180deg, rgba(0, 0, 0, 0) 59.33%, rgba(0, 0, 0, 0.65) 100%); padding: clamp(20px, 20px, 10px)"
                      {% endif %}>       
                      <div class="at_box anim">
                              <div class="fl f-row f-ais" style="gap: 10px;">
                            {% if blk_st.title != blank %}
                            <div class="rgTxt mb0 pr mb5 {{ section_st.ft }}">
                              <span class="uln">{{ blk_st.title }}</span>
                             {% if section_st.count and count != blank %}<span class="pa" style="font-size:10px; font-weight:400">{{ collection.products_count }}</span>{% endif %}
                            </div>
                            {% else %}
                              <div class="rgTxt mb0 pr mb5 {{ section_st.ft }} uln">
                                {{ collection.title }}<span class="pa" style="font-size:10px; font-weight:400">{{ collection.products_count }}</span>
                              </div>
                            {% endif %}
                            </div>
                            {% if blk_st.pretitle != blank and section_st.pretitle_show %}<div class="rgTxt mb5" style="--fs:{{ section_st.pfs }}px;--fsm:{{ section_st.pfsm }}px;">{{ blk_st.pretitle }}</div>{% endif %}
                            {% if blk_st.btntxt != blank %}<button class="btn mt20 {{ section_st.btn-size }} {{ section_st.btn-style }}"  type="button">{{ blk_st.btntxt }}</button>{% endif %}                  
                        </div> 
                       <svg style="width:20px" class="icon icon-arrow-right icon-xs transform shrink-0 hide-md" viewBox="0 0 21 20" stroke="white" fill="none" xmlns="https://www.w3.org/2000/svg">
                       <path stroke-linecap="round" stroke-linejoin="round" d="M3 10H18M18 10L12.1667 4.16675M18 10L12.1667 15.8334"></path>
                      </svg> 
                       </div>
                    {% else %}
                        <span class="pa bottom0 sdetails pa fl f-aic f-jcsb wd100 tc anim zi3 ovhid" style="--rounded:15px;padding: 15px;background: rgba(89, 87, 80, 0.5);backdrop-filter: blur(6px); border-radius: 0 15px 15px;">
                          <span class="rgTxt kug pr ft1">{{collection.title}}
                          <span class="db counts mb5 pa top0 right50" style="--cl:#ffffff;">{{ collection.products_count  }}</span>

                          </span>
                          <span class="hide-md"><svg style="width:20px" class="icon icon-arrow-right icon-xs transform shrink-0 hide-md" viewBox="0 0 21 20" stroke="white" fill="none" xmlns="https://www.w3.org/2000/svg"> <path stroke-linecap="round" stroke-linejoin="round" d="M3 10H18M18 10L12.1667 4.16675M18 10L12.1667 15.8334"></path></svg>
</span>                          </span>
{% endif %}
                      </a>
                </div>
            {% endfor %}
            {% if section.blocks.size == 0 %}{% render 'no-blocks' %}{% endif %}
        {%- endcapture -%}
        {%- capture styles -%}
          --grsp:{{ section_st.gspace | divided_by: 2.0 }}px;--grspm:{{ section_st.gspacem | divided_by: 2.0 }}px;
          --rounded:{{section_st.irad }}px;--cl:{{ section_st.cl }};--fs:{{ section_st.fs }}px;--fsm:{{ section_st.fsm }}px;--fw:{{ section_st.fw }};--lh:{{section_st.lh }};
          --box_bg:{{ section_st.tbg | color_modify:'alpha', section_st.tbg_op }};--tbp:{{ section_st.tbp }}px;
          --psbtm:20px;--psbtmm:15px;
        {%- endcapture -%}
        {%- if section_st.carousel -%}
            <slide-section class="grid gspace rwcols-{{ section_st.gridmb | replace: '.', '_' }} rwcols-md-{{ section_st.gridtb }} rwcols-lg-{{ section_st.grid }} rwcols-xxl-{{ section_st.gridxxl }} collection-grid swiper" style="{{ styles }}"
              data-swiper='{ "slidesPerView":"auto", "loop":{{ section_st.loop }}, {% if section_st.autoplay %}"autoplay":{ "delay":"{{ section_st.speed | times: 1000 }}" },{% endif %} "navigation":{ "nextEl":".swn{{ section.id }}","prevEl":".swp{{ section.id }}" },"pagination":{ "el":".swpg{{ section.id }}","clickable":true }}'>
                <div class="swiper-wrapper">{{ collection_data }}</div>
                {% render 'swiper-navigation', id:section.id, section_st:section_st %}
            </slide-section>
        {%- else -%}
         <div class="grid gspace hide-lg rwcols-{{ section_st.gridmb | replace: '.', '_' }} rwcols-md-{{ section_st.gridtb }} rwcols-lg-{{ section_st.grid }} rwcols-xxl-{{ section_st.gridxxl }} collection-grid listing" style="{{ styles }}">
                {{ collection_data }}
            </div>
            <div class="grid-space gspace collection-grid listing hide-sm hide-md" style="{{ styles }}">
                {{ collection_data }}
            </div>
        {%- endif -%}
    </div>
</div>

{% style %}
.grid-space{  display: grid;
  grid-template-columns: repeat(6, minmax(0, 1fr));}
  .gitem:nth-child(-n + 2) {
  grid-column: span 3;
}
  {% if section.blocks.size >= 5 %}
    .gitem:nth-child(n+3) {
    grid-column: span 2;
    }
    {% else %}
    .gitem:nth-child(n+3) {
    grid-column: span 3;
    }
  {% endif %}
  .gitem .img{position:relative;overflow:hidden}
  .gitem .img::before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to top,rgba(0,0,0,0.8),transparent);z-index:1;pointer-events:none}
{% endstyle %}
{%- endcapture -%}
{{ collection_list | strip_newlines | remove: "  " | remove: "	" }}
{% schema %}
{
    "name": "Collection List (Overlay)",
    "disabled_on": {
        "groups": ["header", "footer", "custom.overlay"]
    },
    "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
        },
        {
          "type": "richtext",
          "id": "subtitle",
          "label": "Sub Heading",
        },
        {
          "type": "checkbox",
          "id": "pretitle_show",
          "label": "Show Subheading",
          "default": true
        },
          {
      "type": "checkbox",
      "id": "italic_fancy_font",
      "label": "Enable Fancy Italic Font"
    },
              {
      "type": "checkbox",
      "id": "enable_design",
      "label": "Small Icon In Front of Subheading"
    },
          {
      "type": "select",
      "id": "italic_font_selection",
      "label": "Fancy Font Selection",
      "info": "Choose which font to use for the italic outline effect",
      "options": [
        {
          "value": "primary",
          "label": "Primary Font"
        },
        {
          "value": "alternative",
          "label": "Alternative Font"
        },
        {
          "value": "secondary",
          "label": "Secondary Font"
        }
      ],
      "default": "primary"
    },
        {
            "type": "header",
            "content": "Grid Appearance ==="
        },  
       {
      "type": "checkbox",
      "id": "enable_background",
      "label": "Enable Card Gradient",
      "default": false
    },
           {
      "type": "checkbox",
      "id": "different_design",
      "label": "Second Design",
      "default": false
    },

      {
        "type": "select",
        "id": "ratio",
        "label": "Image ratio",
        "default": "img",
        "options": [
          {
            "group": "Custom",
            "value": "img",
            "label": "First Image"
          },
          {
                "group": "Landscape",
                "value": "10",
                "label": "0:1"
            },
            {
                "group": "Landscape",
                "value": "15",
                "label": "0:1.5"
            },
            {
                "group": "Landscape",
                "value": "20",
                "label": "0:2"
            },
            {
                "group": "Landscape",
                "value": "25",
                "label": "0:2.5"
            },
            {
                "group": "Landscape",
                "value": "30",
                "label": "0:3"
            },
            {
                "group": "Landscape",
                "value": "35",
                "label": "0:3.5"
            },
            {
                "group": "Landscape",
                "value": "40",
                "label": "0:4"
            },
            {
                "group": "Landscape",
                "value": "45",
                "label": "0:4.5"
            },
          {
            "group": "Landscape",
            "value": "50",
            "label": "0:5"
          },
          {
            "group": "Landscape",
            "value": "60",
            "label": "0:6"
          },
          {
            "group": "Landscape",
            "value": "70",
            "label": "0:7"
          },
          {
            "group": "Landscape",
            "value": "80",
            "label": "0:8"
          },
          {
            "group": "Landscape",
            "value": "90",
            "label": "0:9"
          },
          {
            "group": "Squared",
            "value": "100",
            "label": "1:1"
          },
          {
            "group": "Portrait",
            "value": "110",
            "label": "1:1"
          },
          {
            "group": "Portrait",
            "value": "120",
            "label": "1:2"
          },
          {
            "group": "Portrait",
            "value": "130",
            "label": "1:3"
          },
          {
            "group": "Portrait",
            "value": "140",
            "label": "1:4"
          },
          {
            "group": "Portrait",
            "value": "150",
            "label": "1:5"
          },
          {
            "group": "Portrait",
            "value": "160",
            "label": "1:6"
          },
          {
            "group": "Portrait",
            "value": "170",
            "label": "1:7"
          },
          {
            "group": "Portrait",
            "value": "180",
            "label": "1:8"
          },
          {
            "group": "Portrait",
            "value": "190",
            "label": "1:9"
          }
        ]
      }, 	         
        {
            "type": "range",
            "id": "gspace",
            "label": "Grid gap",
            "default": 15,
            "min": 0,
            "max": 60,
            "step": 1,
            "unit":"px"
        },
        {
            "type": "range",
            "id": "gspacem",
            "label": "Grid gap (mobile)",
            "default": 10,
            "min": 0,
            "max": 30,
            "step": 1,
            "unit":"px"		
        }, 
        {
            "type": "paragraph",
            "content": "Items per row ==="
        },
                {
      "type": "range",
      "id": "gridxxl",
      "label": "Desktop > 1400px",
      "default": 4,
      "min": 2,
      "max": 6,
      "step": 1
    },
       {
            "type": "range",
            "id": "grid",
            "label": "Desktop",
            "default": 4,
            "min": 2,
            "max": 8,
            "step": 1
        },
        {
            "type": "range",
            "id": "gridtb",
            "label": "Tablet",
            "default": 3,
            "min": 1,
            "max": 3,
            "step": 1
        },
        {
        "type": "range",
        "id": "gridmb",
        "label": "Mobile",
        "default": 1.4,
        "min": 1,
        "max": 3,
        "step": 0.1
        },
        {
            "type":"checkbox",
            "id":"count",
            "label":"Show products count?",
            "default": false
        }, 	
         {
            "type": "checkbox",
            "id": "zoom",
            "label": "Image zoom on hover?",
            "default": true
        },
       {
            "type": "range",
            "id": "irad",
            "min": 0,
            "max": 100,
            "step": 1,
            "label": "Image rounded",
            "unit": "px",
            "default": 0
        },    
        {
            "type": "select",
            "id": "btn-style",
            "label": "Button design",
            "default": "btn1",
            "options": [
                {
                    "label": "Button 1",
                    "value": "btn1"
                },
                {
                    "label": "Button 2",
                    "value": "btn2"
                },
                {
                    "label": "Button 3",
                    "value": "btn3"
                },
                {
                    "label": "Button 4",
                    "value": "btn4"
                },
                {
                    "label": "Button 5",
                    "value": "btn5"
                },
			  {
				"label": "Button 6",
				"value": "btn6"
			  },
               {
                  "label": "Button 7 Gradient",
                  "value": "btn7"
              },
              {
                  "label": "Button 8 Gradient",
                  "value": "btn8"
              },
			  {
				"label": "Link",
				"value": "btnLink"
			  }  
            ]
        },
        {
            "type": "select",
            "id": "btn-size",
            "label": "Button size",
            "default": "btn-sm",
            "options": [
                {
                    "label": "Small",
                    "value": "btn-sm"
                },
                {
                    "label": "Medium",
                    "value": "btn-md"
                },
                {
                    "label": "Large",
                    "value": "btn-lg"
                } 		  
            ]
        },            
        {
            "type": "header",
            "content": "Text Appearance ==="
        },    
       {
            "type": "select",
            "id": "text-align",
            "label": "Text alignment",
            "default": "tl",
            "options": [
                {
                    "value": "tl",
                    "label": "Left"
                },
                {
                    "value": "tc f-jcc",
                    "label": "Center"
                },
                {
                    "value": "f-jce",
                    "label": "Right"
                }
            ]
       },
       {
            "type": "paragraph",
            "content": "Pre Heading ==="
        },  
       {
            "type": "range",
            "id": "pfs",
            "label": "Font size",
            "default": 14,
            "min": 8,
            "max": 100,
            "step": 1,
            "unit": "px"
        },
        {
            "type": "range",
            "id": "pfsm",
            "label": "Font size (mobile)",
            "default": 14,
            "min": 8,
            "max": 50,
            "step": 1,
            "unit": "px"
        },   
      {
            "type": "paragraph",
            "content": "Heading ==="
        },  
      {
            "type": "select",
            "id": "ft",
            "label": "Font family",
            "default": "ft1",
            "options": [
                {
                    "value": "ft1",
                    "label": "Font 1"
                },
                {
                    "value": "ft2",
                    "label": "Font 2"
                },
                {
                    "value": "ft3",
                    "label": "Font 3"
                }
            ]
        },
        {
            "type": "range",
            "id": "fs",
            "label": "Font size",
            "default": 20,
            "min": 12,
            "max": 100,
            "step": 1,
            "unit": "px"
        },
        {
            "type": "range",
            "id": "fsm",
            "label": "Font size (mobile)",
            "default": 18,
            "min": 12,
            "max": 50,
            "step": 1,
            "unit": "px"
        },      
        {
                    "type": "range",
                    "id": "lh",
                    "label": "Line height",
                    "default": 1.5,
                    "min": 1.0,
                    "max": 2.0,
                    "step": 0.1              
                },
        {
            "type": "select",
            "id": "fw",
            "label": "Font weight",
            "default": "500",
            "options": [
                {
                    "value": "300",
                    "label": "Light"
                },
                {
                    "value": "400",
                    "label": "Regular"
                },
                {
                    "value": "500",
                    "label": "Medium"
                },
                {
                    "value": "600",
                    "label": "Semi Bold"
                },
                {
                    "value": "700",
                    "label": "Bold"
                }
            ]
        }, 
       {
            "type": "color",
            "id": "cl",
            "label": "Text",
            "default": "#fff"
        },
        {
            "type": "color",
            "id": "tbg",
            "label": "Background",
            "default": "#000"
        },  
       {
            "type": "range",
            "id": "tbg_op",
            "min": 0,
            "max": 1,
            "step": 0.1,
            "label": "Background opacity",           
            "default": 0
        },                
		{
            "type": "header",
            "content": "Slider Settings ==="
        },
        {
            "type":"checkbox",
            "id":"carousel",
            "label":"Enable carousel",
            "default": false
        },
 		{
            "type": "checkbox",
            "id": "loop",
            "label": "Infinite loop",
            "default": true
        },
 		{
            "type": "checkbox",
            "id": "autoplay",
            "label": "Auto-rotate slide",
            "default": false			
        },
        {
            "type": "range",
            "id": "speed",
            "label": "Change slide every",
            "default": 5,
            "min": 1,
            "max": 30,
            "step": 1,
            "unit": "Sec"			
        },		
		{
            "type": "checkbox",
            "id": "arrow",
            "label": "Show arrows on desktop?",
            "default": true			
        },
		{
            "type": "checkbox",
            "id": "arrowm",
            "label": "Show arrows on mobile?",
            "default": false			
        },		
		{
            "type": "checkbox",
            "id": "dot",
            "label": "Show dots on desktop?",
            "default": false			
        },
		{
            "type": "checkbox",
            "id": "dotm",
            "label": "Show dots on mobile?",
            "default": true			
        },
		{
            "type": "header",
            "content": "Section Design ==="
        },
       {
            "type":"checkbox",
            "id":"sw",
            "label":"Fullwidth?",
            "default": false           
        },	
        {
            "type":"checkbox",
            "id":"npd",
            "label":"No padding?",
            "default": true,
            "info":"Remove left/right padding for fullwidth"
        },
        {
            "type": "color",
            "id": "bg",
            "label": "Background",
            "default":"#fff"	
        },
        {
            "type": "color_background",
            "id": "bgg",
            "label": "Gradient background"
        },	
        {
            "type": "image_picker",
            "id": "bgimg",
            "label": "Background image"
          }, 
        {
            "type": "color",
            "id": "overlay",
            "label": "Image overlay",
            "default": "#3d4246"
        },
        {
            "type": "range",
            "id": "overlay_op",
            "min": 0,
            "max": 1,
            "step": 0.1,
            "label": "Overlay opacity",
            "unit": "%",
            "default": 0
        },
       {
            "type": "color",
            "id": "headings_cl",
            "label": "Text"
        },
		{
			"type": "range",
			"id": "sst",
			"min": 0,
			"max": 100,
			"step": 2,
			"label": "Spacing top",
			"unit": "px",
			"default":40
        },
		{
			"type": "range",
			"id": "ssb",
			"min": 0,
			"max": 100,
			"step": 2,
			"label": "Spacing bottom",
			"unit": "px",
			"default":40
        },		
		{
			"type": "range",
			"id": "sstm",
			"min": 0,
			"max": 100,
			"step": 5,
			"label": "Spacing top (mobile)",
			"unit": "px",
			"default":15
        },
		{
			"type": "range",
			"id": "ssbm",
			"min": 0,
			"max": 100,
			"step": 5,
			"label": "Spacing bottom (mobile)",
			"unit": "px",
			"default":15
        },
         {
            "type": "checkbox",
            "id": "hidem",
            "label": "Hide on mobile?",
            "default": false
        },
        {
            "type": "checkbox",
            "id": "hided",
            "label": "Hide on desktop?",
            "default": false
        },
                {
            "type": "range",
            "id": "pdr",
            "label": "Padding Right",
            "default": 15,
            "min": 0,
            "max": 60,
            "step": 1,
            "unit":"px"
        },
        {
            "type": "range",
            "id": "pdl",
            "label": "Padding left",
            "default": 10,
            "min": 0,
            "max": 30,
            "step": 1,
            "unit":"px"		
        }, 
    ],
    "blocks": [
        {
            "type": "collection",
            "name": "Collection",
            "settings": [
                {
                    "label": "Collection",
                    "id": "collection",
                    "type": "collection"
                },
        {
          "type": "header",
          "content": "Media Settings"
        },
        {
          "type": "select",
          "id": "media_type",
          "label": "Media Type",
          "options": [
            {
              "value": "image",
              "label": "Image"
            },
            {
              "value": "video",
              "label": "Video"
            }
          ],
          "default": "image"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Collection Image"
        },
        {
          "type": "video",
          "id": "video",
          "label": "Collection Video",
          "info": "Upload video file. Video will autoplay, loop, and be muted."
        },
               {
                    "type":"text",
                    "id":"pretitle",
                    "label":"Title",
                    "default":"Pre Heading"                   
                },
                {
                    "type":"text",
                    "id":"title",
                    "label":"Title",
                    "default":"Heading"                   
                },
                {
                    "type": "text",
                    "id": "btntxt",
                    "label": "Button text",            
                    "info":"Keep empty to hide button" 
                },
                {
                    "type": "url",
                    "id": "url",
                    "label": "Link (optional)",
                    "info": "Keep empty to use 'collection url'."
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Main Collection",      
            "settings": {
                "grid": 4
            },
            "blocks": [
                {
                    "type": "collection"
                },
                {
                    "type": "collection"
                },
                {
                    "type": "collection"
                },
                {
                    "type": "collection"
                }
            ]
        }
    ]
}
{% endschema %}