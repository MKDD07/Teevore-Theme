{%- liquid
  assign section_st = section.settings
  assign promotion_blocks = section.blocks | where: 'type', 'bar'
  assign social_blocks = section.blocks | where: 'type', 'sc'
  assign currency_blocks = section.blocks | where: 'type', 'cl'
-%}

{%- if section_st.arr_show == 'forever' -%}
  <style>
    .top-promo .swarw { opacity: 1; }
  </style>
{%- endif -%}
  <div
  class="sec_cov promo {% if section_st.hidem %} hide-sm{% endif %}{% if section_st.hided %} hide-md hide-lg{% endif %}{% if section_st.bgimg != blank %} bgImg lazyload{% endif %}"
  style="
    --sbg:{% if section_st.bgg != blank %}{{ section_st.bgg }}{% else %}{% unless request.path contains '/collections/women' or template contains  'girls_collections' %}{{ settings.bgs }}{% else %}{{ settings.bgl }}{% endunless %}{% endif %};
    --sst:{{ section_st.sst }}px;
    --ssb:{{ section_st.ssb }}px;
    --sstm:{{ section_st.sstm }}px;
    --ssbm:{{ section_st.ssbm }}px;
    --overlay:{{ section_st.overlay | color_modify: 'alpha', section_st.overlay_op }};
  "
  {%- if section_st.bgimg != blank -%}
    data-bgset="{{ section_st.bgimg | image_url: width: section_st.bgimg.width }}"
    data-sizes="auto"
    data-parent-fit="contain"
  {%- endif -%}
>
  <div
    id="{{ section.id }}"
    class="{% if section_st.sw %} fw-sec{% else %}page-width{% endif %} top-promo zi1 pr fl"
    style="
      --fs:{{ section_st.fts }}px;
      --fs_dot:{{ section_st.fts | minus: 1 }}px;
      --fsl:{{ section_st.fts }}px;
      --fsm:{{ section_st.ftsm }}px;
      --lh:{{ section_st.lh }};
      --fw:{{ section_st.fw }};
      --mwidth:{{ section_st.fts | plus: 5 }}px;
      --cl:{{ section_st.cl }};
      --clhl:{{ section_st.clhl }};
      --btncl:{{ section_st.btncl }};
      --btnbg:{{ section_st.btnbg }};
    "
  >
    {%- comment -%} Social Media Section {%- endcomment -%}
    {%- if social_blocks.size > 0 -%}
      {%- assign social_block = social_blocks.first -%}
      <div
        class="{{ social_block.settings.al }} tscl fl1 wd20 hide-sm hide-md"
      >
        {%- render 'social-media' -%}
      </div>
    {%- endif -%}

    {%- comment -%} Promotion Messages Section {%- endcomment -%}
    {%- if promotion_blocks.size > 0 -%}
      {%- if promotion_blocks.size > 1 -%}
        <slide-section
          class="flslieds swiper wd60-lg wd100"
          data-swiper='
            {
              "slidesPerView": "1",
              "loop": true,
              {% if section_st.autoplay %}"autoplay": { "delay": "{{ section_st.speed | times: 1000 }}" },{% endif %}
              {% if section_st.fade %}"effect": "fade",{% endif %}
              "navigation": {
                "nextEl": ".swn{{ section.id }}",
                "prevEl": ".swp{{ section.id }}"
              }
            }
          '
        >
          <div class="swiper-wrapper f-aic">
      {%- endif -%}

      {%- for block in promotion_blocks -%}
        {%- assign blk_st = block.settings -%}
        {%- assign has_countdown = false -%}
        {%- assign has_button = false -%}
        {%- if blk_st.title contains '[countdown]' -%}
          {%- assign has_countdown = true -%}
        {%- endif -%}
        {%- if blk_st.title contains '[button]' and blk_st.btn_txt != blank -%}
          {%- assign has_button = true -%}
        {%- endif -%}

        <div
          class="{% if promotion_blocks.size > 1 %}swiper-slide {% endif %} fckSl"
          id="{{ block.id }}"
          {{ block.shopify_attributes }}
        >
          {%- if blk_st.title != blank -%}
            {%- assign display_title = blk_st.title -%}

            {%- if has_countdown -%}
              {%- capture countdown_html -%}
                <countdown-time class="atCounter inline_timer fl f-aic ttu" style="--cl:{{ section_st.cnt_txt }};" data-date="{{ blk_st.date }}">
                  <span><span class="tm days">00</span> {{ 'date_formats.days_short' | t }} <span class="timerdot">:</span></span>
                  <span><span class="tm hours">00</span> {{ 'date_formats.hours_short' | t }} <span class="timerdot">:</span></span>
                  <span><span class="tm minutes">00</span> {{ 'date_formats.minuts_short' | t }} <span class="timerdot">:</span></span>
                  <span><span class="seconds">00</span> {{ 'date_formats.seconds_short' | t }}</span>
                </countdown-time>
              {%- endcapture -%}
              {%- assign display_title = display_title | replace: '[countdown]', countdown_html -%}
            {%- endif -%}

            {%- if has_button -%}
              {%- capture button_html -%}
                <span class="pr btn btn-sm{% if blk_st.hdbtn %} hide-sm{% endif %}">{{ blk_st.btn_txt }}</span>
              {%- endcapture -%}
              {%- assign display_title = display_title | replace: '[button]', button_html -%}
            {%- endif -%}

            <a
              {% if blk_st.link != blank %}
                href="{{ blk_st.link }}"
              {% else %}
                role="link" aria-disabled="true"
              {% endif %}
              class="promo_msg rgTxt fl f-jcc f-aic col-gap {{ section_st.fontFm }} tc"
              style="--gap:10px; --min-height: 30px;"
            >
              {{ display_title }}
            </a>
          {%- endif -%}
        </div>
      {%- endfor -%}

      {%- if promotion_blocks.size > 1 -%}
        </div>
        {%- render 'swiper-navigation', id: section.id, section_st: section_st -%}
        </slide-section>
      {%- endif -%}
    {%- endif -%}

    {%- comment -%} Currency/Language Section {%- endcomment -%}
    {%- if currency_blocks.size > 0 -%}
      {%- assign currency_block = currency_blocks.first -%}
      {%- assign cl_st = currency_block.settings -%}
      <div
        class="money-selection wd20 fl f-jce hide-sm hide-md {{ cl_st.al }}"
      >
        {%- if cl_st.sc -%}
          {%- render 'social-media' -%}
        {%- endif -%}

        {%- if cl_st.menu != blank and linklists[cl_st.menu].links.size > 0 -%}
          {%- for link in linklists[cl_st.menu].links -%}
            <a href="{{ link.url }}" class="menu-link">{{ link.title }}</a>
          {%- endfor -%}
        {%- endif -%}

        {%- if cl_st.txt != blank -%}
          <div class="custom-text">{{ cl_st.txt }}</div>
        {%- endif -%}

        {%- if settings.mlcurrency or settings.mlLang -%}
          {%- render 'currencyLang' -%}
          {% else %}
      <a class="btn btn-smd btn3" href="{{ section.settings.track_order }}">
        {{ section.settings.track_order_text }}
      </a>        
      {%- endif -%}
      </div>
    {%- endif -%}
  </div>
</div>
{%- style -%}
  #{{ section.id }} .rgTxt {
    margin-bottom: 0 !important;
  }
{%- endstyle -%}

{% schema %}
{
  "name": "Promotion Bar",
  "class": "index-section",
  "max_blocks": 5,
  "disabled_on": {
    "groups": ["custom.overlay"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Text Appearance"
    },
    {
      "type": "select",
      "id": "fontFm",
      "label": "Font family",
      "default": "ft1",
      "options": [
        { "value": "ft1", "label": "Font 1" },
        { "value": "ft2", "label": "Font 2" },
        { "value": "ft3", "label": "Font 3" }
      ]
    },
    {
      "type": "range",
      "id": "fts",
      "label": "Font size",
      "default": 18,
      "min": 10,
      "max": 100,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "ftsm",
      "label": "Font size (mobile)",
      "default": 13,
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "fw",
      "label": "Font weight",
      "default": "600",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ]
    },
    {
      "type": "range",
      "id": "lh",
      "label": "Line height",
      "default": 1.0,
      "min": 1.0,
      "max": 2.0,
      "step": 0.1
    },
    {
      "type": "color",
      "id": "cl",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "clhl",
      "label": "Highlight text",
      "default": "#ffde00"
    },
    {
      "type": "color",
      "id": "cnt_txt",
      "label": "Countdown text",
      "default": "#e74646"
    },
    {
      "type": "color",
      "id": "btncl",
      "label": "Button text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "btnbg",
      "label": "Button background",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Slider Settings"
    },
    {
      "type": "checkbox",
      "id": "fade",
      "label": "Slide fade effect",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Auto-rotate slide",
      "default": false
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Change slide every",
      "default": 5,
      "min": 1,
      "max": 30,
      "step": 1,
      "unit": "sec"
    },
    {
      "type": "checkbox",
      "id": "arrow",
      "label": "Show arrows (desktop)",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "arrowm",
      "label": "Show arrows (mobile)",
      "default": false
    },
    {
      "type": "select",
      "id": "arr_show",
      "label": "Arrows visibility",
      "default": "hover",
      "options": [
        { "value": "hover", "label": "Show on Hover" },
        { "value": "forever", "label": "Always Show" }
      ]
    },
    {
      "type": "header",
      "content": "Section Design"
    },
    {
      "type": "checkbox",
      "id": "sw",
      "label": "Full width",
      "default": true
    },
    {
      "type": "color_background",
      "id": "bgg",
      "label": "Gradient background"
    },
    {
      "type": "image_picker",
      "id": "bgimg",
      "label": "Background image"
    },
    {
      "type": "color",
      "id": "overlay",
      "label": "Image overlay",
      "default": "#3d4246"
    },
    {
      "type": "range",
      "id": "overlay_op",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Overlay opacity",
      "default": 0
    },
    {
      "type": "range",
      "id": "sst",
      "min": 0,
      "max": 100,
      "step": 5,
      "label": "Spacing top",
      "unit": "px",
      "default": 10
    },
    {
      "type": "range",
      "id": "ssb",
      "min": 0,
      "max": 100,
      "step": 5,
      "label": "Spacing bottom",
      "unit": "px",
      "default": 10
    },
    {
      "type": "range",
      "id": "sstm",
      "min": 0,
      "max": 100,
      "step": 5,
      "label": "Spacing top (mobile)",
      "unit": "px",
      "default": 5
    },
    {
      "type": "range",
      "id": "ssbm",
      "min": 0,
      "max": 100,
      "step": 5,
      "label": "Spacing bottom (mobile)",
      "unit": "px",
      "default": 5
    },
    {
      "type": "checkbox",
      "id": "hidem",
      "label": "Hide on mobile",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "hided",
      "label": "Hide on desktop",
      "default": false
    },
    {
      "type": "url",
      "id": "track_order",
      "label": "Track Order Link",
      "info":"Disable Settings from main Schema Setting Both Currency and Language only That Will Work"
    },
    {
      "type": "text",
      "id": "track_order_text",
      "label": "Track Order Link Text",
      "default": "Track Order"
    }
  ],
  "blocks": [
    {
      "type": "bar",
      "name": "Promotion text",
      "settings": [
        {
          "type": "textarea",
          "id": "title",
          "label": "Promotion text",
          "default": "UP TO 80% OFF ON THE ENTIRE STORE! Hurry up!",
          "info": "Use [countdown] to show countdown timer, [button] to show button, and <span class=\"hl\">text</span> for text highlight"
        },
        {
          "type": "text",
          "id": "date",
          "label": "End date",
          "info": "Format: mm/dd/yyyy",
          "default": "12/31/2024"
        },
        {
          "type": "text",
          "id": "btn_txt",
          "label": "Button text",
          "default": "Shop Now"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Button link"
        },
        {
          "type": "checkbox",
          "id": "hdbtn",
          "label": "Hide button on mobile",
          "default": true
        }
      ]
    },
    {
      "type": "sc",
      "name": "Social Icons",
      "settings": [
        {
          "type": "checkbox",
          "id": "hdm",
          "label": "Hide on mobile",
          "default": false
        },
        {
          "type": "select",
          "id": "al",
          "label": "Alignment",
          "default": "tl",
          "options": [
            { "value": "tl", "label": "Left" },
            { "value": "tc f-jcc", "label": "Center" },
            { "value": "tr f-jce", "label": "Right" }
          ]
        }
      ]
    },
    {
      "type": "cl",
      "name": "Currency & Language",
      "settings": [
        {
          "type": "paragraph",
          "content": "Manage currency & language settings in Theme Settings"
        },
        {
          "type": "checkbox",
          "id": "sc",
          "label": "Show social media",
          "default": false
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "Select menu"
        },
        {
          "type": "textarea",
          "id": "txt",
          "label": "Custom text"
        },
        {
          "type": "checkbox",
          "id": "hdm",
          "label": "Hide on mobile",
          "default": false
        },
        {
          "type": "select",
          "id": "al",
          "label": "Alignment",
          "default": "tr f-jce",
          "options": [
            { "value": "tl", "label": "Left" },
            { "value": "tc f-jcc", "label": "Center" },
            { "value": "tr f-jce", "label": "Right" }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Promotion Bar",
      "blocks": [
        {
          "type": "bar"
        }
      ]
    }
  ]
}
{% endschema %}
