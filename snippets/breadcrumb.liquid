{%- capture breadcrumb -%}
{% assign section_st = section.settings %}  
{% unless template == 'index' %}
<nav class="breadcrumb fl f-wrap f-aic{% if section_st.tc %} tc{% endif %}{% if section_st.hidemb %} hide-sm{% endif %}" role="navigation" aria-label="breadcrumbs">
    <a style="color:{{section_st.h1color}}" class="fwb" href="{{ routes.root_url }}" title="{{ 'general.breadcrumbs.home_link_title' | t }}">
      {% if settings.home_display == 'text' %}
        {{ 'general.breadcrumbs.home' | t }}
      {% else %}
        {{ section_st.svg_code }}
      {% endif %}
    </a>
    {% if template contains 'product' %}
        {% comment %} Check for collection context or use product's first collection {% endcomment %}
        {% assign breadcrumb_collection = collection %}
        {% unless breadcrumb_collection %}
            {% assign breadcrumb_collection = product.collections.first %}
        {% endunless %}
        
        {% if breadcrumb_collection and breadcrumb_collection.handle != blank %}
            <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
            {% capture collection_url %}{{ routes.collections_url }}/{{ breadcrumb_collection.handle }}{% endcapture %}
            <a style="color:{{section_st.h1color}}" class="fwm" href="{{ collection_url }}">{{ breadcrumb_collection.title }}</a>
        {% endif %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <span style="color:{{section_st.h1color}}" class="fwm">{{ product.title }}</span>
    {% elsif template contains 'collection' and collection.handle %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        {% if current_tags %}
            {% capture collection_url %}{{ routes.collections_url }}/{{ collection.handle }}{% endcapture %}
            <a style="color:{{section_st.h1color}}" class="fwm" href="{{ collection_url }}">{{ collection.title }}</a>
            <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
            <span style="color:{{section_st.h1color}}" class="fwm">{{ current_tags | join: " + " }}</span>
        {% else %}
            <span style="color:{{section_st.h1color}}" class="fwm">{{ collection.title }}</span>
        {% endif %}
    {% elsif template == 'blog' %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        {% if current_tags %}
            <a style="color:{{section_st.h1color}}" class="fwm" href="{{ blog.url }}">{{ blog.title }}</a>
            <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
            <span style="color:{{section_st.h1color}}" class="fwm">{{ current_tags | join: " + " }}</span>
        {% else %}
            <span style="color:{{section_st.h1color}}" class="fwm">{{ blog.title }}</span>
        {% endif %}
    {% elsif template == 'article' %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <a style="color:{{section_st.h1color}}" class="fwm" href="{{ blog.url }}">{{ blog.title }}</a>
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <span style="color:{{section_st.h1color}}" class="fwm">{{ article.title }}</span>
    {% elsif template contains 'page' %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <span style="color:{{section_st.h1color}}" class="fwm">{{ page.title }}</span>
    {% elsif template contains 'cart' %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <span style="color:{{section_st.h1color}}" class="fwm">{{ 'cart.general.title' | t }}</span>
    {% else %}
        <span style="color:{{section_st.h1color}}" class="barr" aria-hidden="true">Collections / <use xlink:href="#icon-arrow"></use></svg></span>
        <span style="color:{{section_st.h1color}}" class="fwm">{{ page_title }}</span>
    {% endif %}
</nav>

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "item": {
                "@id": "{{ routes.root_url }}",
                "name": "{{ 'general.breadcrumbs.home' | t }}"
            }
        }
        {% if template contains 'product' %}
            {% assign breadcrumb_collection = collection %}
            {% unless breadcrumb_collection %}
                {% assign breadcrumb_collection = product.collections.first %}
            {% endunless %}
            {% if breadcrumb_collection and breadcrumb_collection.handle != blank %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ routes.collections_url }}/{{ breadcrumb_collection.handle }}",
                    "name": "{{ breadcrumb_collection.title }}"
                }
            },
            {
                "@type": "ListItem",
                "position": 3,
                "item": {
                    "@id": "{{ product.url | within: breadcrumb_collection }}",
                    "name": "{{ product.title }}"
                }
            }
            {% else %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ product.url }}",
                    "name": "{{ product.title }}"
                }
            }
            {% endif %}
        {% elsif template == 'list-collections' %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ routes.collections_url }}",
                    "name": "{{ 'collections.general.all' | t }}"
                }
            }
        {% elsif template contains 'collection' and collection.handle %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ routes.collections_url }}/{{ collection.handle }}",
                    "name": "{{ collection.title }}"
                }
            }
            {% if current_tags %}
            ,{
                "@type": "ListItem",
                "position": 3,
                "item": {
                    "@id": "{{ blog.url }}/tagged/{{ current_tags | join: '+' }}",
                    "name": "{{ current_tags | join: " + " }}"
                }
            }
            {% endif %}
        {% elsif template == 'blog' %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ blog.url }}",
                    "name": "{{ blog.title }}"
                }
            }
            {% if current_tags %}
            ,{
                "@type": "ListItem",
                "position": 3,
                "item": {
                    "@id": "{{ blog.url }}/tagged/{{ current_tags | join: '+' }}",
                    "name": "{{ current_tags | join: " + " }}"
                }
            }
            {% endif %}
        {% elsif template == 'article' %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ blog.url }}",
                    "name": "{{ blog.title }}"
                }
            },
            {
                "@type": "ListItem",
                "position": 3,
                "item": {
                    "@id": "{{ article.url }}",
                    "name": "{{ article.title }}"
                }
            }
        {% elsif template contains 'page' %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ page.url }}",
                    "name": "{{ page.title }}"
                }
            }
        {% else %}
            ,{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "{{ canonical_url | default: page.url }}",
                    "name": "{{ page_title }}"
                }
            }
        {% endif %}
    ]
}
</script>
{% endunless %}
{%- endcapture -%}
{{ breadcrumb | strip_newlines | remove: "  " | remove: "	" }}